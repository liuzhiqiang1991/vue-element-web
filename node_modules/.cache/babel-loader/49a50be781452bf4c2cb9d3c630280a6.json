{"remainingRequest":"/Users/root1/Desktop/学习/vue-element-web/node_modules/babel-loader/lib/index.js!/Users/root1/Desktop/学习/vue-element-web/node_modules/cache-loader/dist/cjs.js??ref--0-0!/Users/root1/Desktop/学习/vue-element-web/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/root1/Desktop/学习/vue-element-web/src/components/EuserUpload/index.vue?vue&type=script&lang=js&","dependencies":[{"path":"/Users/root1/Desktop/学习/vue-element-web/src/components/EuserUpload/index.vue","mtime":1621172705000},{"path":"/Users/root1/Desktop/学习/vue-element-web/node_modules/cache-loader/dist/cjs.js","mtime":1621132353000},{"path":"/Users/root1/Desktop/学习/vue-element-web/node_modules/babel-loader/lib/index.js","mtime":1621132352000},{"path":"/Users/root1/Desktop/学习/vue-element-web/node_modules/cache-loader/dist/cjs.js","mtime":1621132353000},{"path":"/Users/root1/Desktop/学习/vue-element-web/node_modules/vue-loader/lib/index.js","mtime":1621132357000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KaW1wb3J0IHsgZ2V0VG9rZW4gfSBmcm9tICcuLi8uLi91dGlscy9hdXRoJzsKZXhwb3J0IGRlZmF1bHQgewogIHByb3BzOiB7CiAgICBmaWxlTGlzdDogewogICAgICB0eXBlOiBBcnJheSwKICAgICAgZGVmYXVsdDogZnVuY3Rpb24gX2RlZmF1bHQoKSB7CiAgICAgICAgcmV0dXJuIFtdOwogICAgICB9CiAgICB9LAogICAgZGlzYWJsZWQ6IHsKICAgICAgdHlwZTogQm9vbGVhbiwKICAgICAgZGVmYXVsdDogZmFsc2UKICAgIH0KICB9LAogIGNvbXB1dGVkOiB7CiAgICBoZWFkZXJzOiBmdW5jdGlvbiBoZWFkZXJzKCkgewogICAgICByZXR1cm4gewogICAgICAgIEF1dGhvcml6YXRpb246ICJCZWFyZXIgIi5jb25jYXQoZ2V0VG9rZW4oKSkKICAgICAgfTsKICAgIH0KICB9LAogIGRhdGE6IGZ1bmN0aW9uIGRhdGEoKSB7CiAgICByZXR1cm4gewogICAgICBhY3Rpb246ICIiLmNvbmNhdChwcm9jZXNzLmVudi5WVUVfQVBQX0JBU0VfQVBJLCAiYm9vay91cGxvYWQiKQogICAgfTsKICB9LAogIG1ldGhvZHM6IHsKICAgIGJlZm9yZVVwbG9hZDogZnVuY3Rpb24gYmVmb3JlVXBsb2FkKGZpbGUpIHsKICAgICAgY29uc29sZS5sb2coZmlsZSk7IC8vYWxlcnQoYEJlYXJlciAke2dldFRva2VuKCl9YCkKCiAgICAgIHRoaXMuJGVtaXQoJ2JlZm9yZVVwbG9hZCcsIGZpbGUpOwogICAgfSwKICAgIG9uU3VjY2VzczogZnVuY3Rpb24gb25TdWNjZXNzKHJlc3BvbnNlLCBmaWxlKSB7CiAgICAgIGNvbnNvbGUubG9nKHJlc3BvbnNlLCBmaWxlKTsKICAgICAgdmFyIGNvZGUgPSByZXNwb25zZS5jb2RlLAogICAgICAgICAgbXNnID0gcmVzcG9uc2UubXNnOwoKICAgICAgaWYgKGNvZGUgPT09IDApIHsKICAgICAgICB0aGlzLiRtZXNzYWdlKHsKICAgICAgICAgIG1lc3NhZ2U6IG1zZywKICAgICAgICAgIHR5cGU6ICdzdWNjZXNzJwogICAgICAgIH0pOwogICAgICAgIHRoaXMuJGVtaXQoJ29uU3VjY2VzcycsIGZpbGUpOwogICAgICB9IGVsc2UgewogICAgICAgIHRoaXMuJG1lc3NhZ2UoewogICAgICAgICAgbWVzc2FnZTogbXNnICYmICJcdTRFMEFcdTRGMjBcdTU5MzFcdThEMjVcdUZGMENcdTU5MzFcdThEMjVcdTUzOUZcdTU2RTBcdUZGMUEiLmNvbmNhdChtc2cpIHx8ICfkuIrkvKDlpLHotKUnLAogICAgICAgICAgdHlwZTogJ2Vycm9yJwogICAgICAgIH0pOwogICAgICAgIHRoaXMuJGVtaXQoJ29uRXJyb3InLCBmaWxlKTsKICAgICAgfQogICAgfSwKICAgIG9uRXJyb3I6IGZ1bmN0aW9uIG9uRXJyb3IoZXJyKSB7CiAgICAgIGNvbnNvbGUubG9nKGVycik7CiAgICAgIHZhciBlcnJNc2cgPSBlcnIubWVzc2FnZSAmJiBKU09OLnBhcnNlKGVyci5tZXNzYWdlKTsKICAgICAgdGhpcy4kbWVzc2FnZSh7CiAgICAgICAgbWVzc2FnZTogZXJyTXNnICYmIGVyck1zZy5tc2cgJiYgIlx1NEUwQVx1NEYyMFx1NTkzMVx1OEQyNVx1RkYwQ1x1NTkzMVx1OEQyNVx1NTM5Rlx1NTZFMFx1RkYxQSIuY29uY2F0KGVyck1zZy5tc2cpIHx8ICfkuIrkvKDlpLHotKUnLAogICAgICAgIHR5cGU6ICdlcnJvcicKICAgICAgfSk7CiAgICB9LAogICAgb25SZW1vdmU6IGZ1bmN0aW9uIG9uUmVtb3ZlKCkgewogICAgICB0aGlzLiRtZXNzYWdlKHsKICAgICAgICBtZXNzYWdlOiAn55S16KeG5Lmm5Yig6Zmk5oiQ5YqfJywKICAgICAgICB0eXBlOiAnc3VjY2VzcycKICAgICAgfSk7CiAgICAgIHRoaXMuJGVtaXQoJ29uUmVtb3ZlJyk7CiAgICB9LAogICAgb25FeGNlZWQ6IGZ1bmN0aW9uIG9uRXhjZWVkKCkgewogICAgICB0aGlzLiRtZXNzYWdlKHsKICAgICAgICBtZXNzYWdlOiAn5q+P5qyh5Y+q6IO95LiK5Lyg5LiA5pys55S15a2Q5LmmJywKICAgICAgICB0eXBlOiAnd2FybmluZycKICAgICAgfSk7CiAgICB9CiAgfQp9Ow=="},{"version":3,"sources":["index.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;AA8BA,SAAA,QAAA,QAAA,kBAAA;AACA,eAAA;AACA,EAAA,KAAA,EAAA;AACA,IAAA,QAAA,EAAA;AACA,MAAA,IAAA,EAAA,KADA;AAEA,MAAA,OAFA,sBAEA;AACA,eAAA,EAAA;AACA;AAJA,KADA;AAOA,IAAA,QAAA,EAAA;AACA,MAAA,IAAA,EAAA,OADA;AAEA,MAAA,OAAA,EAAA;AAFA;AAPA,GADA;AAaA,EAAA,QAAA,EAAA;AACA,IAAA,OADA,qBACA;AACA,aAAA;AACA,QAAA,aAAA,mBAAA,QAAA,EAAA;AADA,OAAA;AAGA;AALA,GAbA;AAoBA,EAAA,IApBA,kBAoBA;AACA,WAAA;AACA,MAAA,MAAA,YAAA,OAAA,CAAA,GAAA,CAAA,gBAAA;AADA,KAAA;AAGA,GAxBA;AAyBA,EAAA,OAAA,EAAA;AACA,IAAA,YADA,wBACA,IADA,EACA;AACA,MAAA,OAAA,CAAA,GAAA,CAAA,IAAA,EADA,CAEA;;AACA,WAAA,KAAA,CAAA,cAAA,EAAA,IAAA;AACA,KALA;AAMA,IAAA,SANA,qBAMA,QANA,EAMA,IANA,EAMA;AACA,MAAA,OAAA,CAAA,GAAA,CAAA,QAAA,EAAA,IAAA;AACA,UAAA,IAAA,GAAA,QAAA,CAAA,IAAA;AAAA,UAAA,GAAA,GAAA,QAAA,CAAA,GAAA;;AACA,UAAA,IAAA,KAAA,CAAA,EAAA;AACA,aAAA,QAAA,CAAA;AACA,UAAA,OAAA,EAAA,GADA;AAEA,UAAA,IAAA,EAAA;AAFA,SAAA;AAIA,aAAA,KAAA,CAAA,WAAA,EAAA,IAAA;AACA,OANA,MAMA;AACA,aAAA,QAAA,CAAA;AACA,UAAA,OAAA,EAAA,GAAA,0EAAA,GAAA,CAAA,IAAA,MADA;AAEA,UAAA,IAAA,EAAA;AAFA,SAAA;AAIA,aAAA,KAAA,CAAA,SAAA,EAAA,IAAA;AACA;AACA,KAtBA;AAuBA,IAAA,OAvBA,mBAuBA,GAvBA,EAuBA;AACA,MAAA,OAAA,CAAA,GAAA,CAAA,GAAA;AACA,UAAA,MAAA,GAAA,GAAA,CAAA,OAAA,IAAA,IAAA,CAAA,KAAA,CAAA,GAAA,CAAA,OAAA,CAAA;AACA,WAAA,QAAA,CAAA;AACA,QAAA,OAAA,EAAA,MAAA,IAAA,MAAA,CAAA,GAAA,0EAAA,MAAA,CAAA,GAAA,CAAA,IAAA,MADA;AAEA,QAAA,IAAA,EAAA;AAFA,OAAA;AAIA,KA9BA;AA+BA,IAAA,QA/BA,sBA+BA;AACA,WAAA,QAAA,CAAA;AACA,QAAA,OAAA,EAAA,SADA;AAEA,QAAA,IAAA,EAAA;AAFA,OAAA;AAIA,WAAA,KAAA,CAAA,UAAA;AACA,KArCA;AAsCA,IAAA,QAtCA,sBAsCA;AACA,WAAA,QAAA,CAAA;AACA,QAAA,OAAA,EAAA,aADA;AAEA,QAAA,IAAA,EAAA;AAFA,OAAA;AAIA;AA3CA;AAzBA,CAAA","sourcesContent":["<template>\n  <div class=\"upload-container\">\n    <el-upload\n      :action=\"action\"\n      :headers=\"headers\"\n      :multiple=\"false\"\n      :limit=\"1\"\n      :before-upload=\"beforeUpload\"\n      :on-success=\"onSuccess\"\n      :on-error=\"onError\"\n      :on-remove=\"onRemove\"\n      :file-list=\"fileList\"\n      :on-exceed=\"onExceed\"\n      :disabled=\"disabled\"\n      drag\n      show-file-list\n      accept=\"application/epub+zip\"\n      class=\"image-upload\"\n    >\n      <i class=\"el-icon-upload\" />\n      <div class=\"el-upload__text\" v-if=\"fileList.length === 0\">\n        请将电子书拖入或<em>点击上传</em>\n      </div>\n      <div class=\"el-upload__text\" v-else>\n        图书已上传\n      </div>\n    </el-upload>\n  </div>\n</template>\n<script>\nimport { getToken } from '../../utils/auth'\nexport default {\n  props: {\n    fileList: {\n      type: Array,\n      default() {\n        return []\n      }\n    },\n    disabled: {\n      type: Boolean,\n      default: false\n    }\n  },\n  computed: {\n    headers() {\n      return {\n        Authorization: `Bearer ${getToken()}`\n      }\n    }\n  },\n  data() {\n    return {\n      action: `${process.env.VUE_APP_BASE_API}book/upload`\n    }\n  },\n  methods: {\n    beforeUpload(file) {\n      console.log(file)\n      //alert(`Bearer ${getToken()}`)\n      this.$emit('beforeUpload', file)\n    },\n    onSuccess(response, file) {\n      console.log(response, file)\n      const { code, msg } = response\n      if(code === 0) {\n        this.$message({\n          message: msg,\n          type: 'success'\n        })\n        this.$emit('onSuccess', file)\n      } else {\n        this.$message({\n          message: (msg && `上传失败，失败原因：${msg}`) || '上传失败',\n          type: 'error'\n        })\n        this.$emit('onError', file)\n      }\n    },\n    onError(err) {\n      console.log(err)\n      const errMsg = err.message && JSON.parse(err.message)\n      this.$message({\n        message: (errMsg && errMsg.msg && `上传失败，失败原因：${errMsg.msg}`) || '上传失败',\n        type: 'error'\n      })\n    },\n    onRemove() {\n      this.$message({\n        message: '电视书删除成功',\n        type: 'success'\n      })\n      this.$emit('onRemove')\n    },\n    onExceed() {\n      this.$message({\n        message: '每次只能上传一本电子书',\n        type: 'warning'\n      })\n    }\n  }\n}\n</script>\n<style lang=\"scss\" scoped></style>\n"],"sourceRoot":"src/components/EbookUpload"}]}