{"remainingRequest":"/Users/root1/Desktop/学习/vue-element-web/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/root1/Desktop/学习/vue-element-web/src/views/book/components/Detail.vue?vue&type=script&lang=js&","dependencies":[{"path":"/Users/root1/Desktop/学习/vue-element-web/src/views/book/components/Detail.vue","mtime":1621169398000},{"path":"/Users/root1/Desktop/学习/vue-element-web/node_modules/cache-loader/dist/cjs.js","mtime":1621132353000},{"path":"/Users/root1/Desktop/学习/vue-element-web/node_modules/babel-loader/lib/index.js","mtime":1621132352000},{"path":"/Users/root1/Desktop/学习/vue-element-web/node_modules/cache-loader/dist/cjs.js","mtime":1621132353000},{"path":"/Users/root1/Desktop/学习/vue-element-web/node_modules/vue-loader/lib/index.js","mtime":1621132357000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KCmltcG9ydCBTdGlja3kgZnJvbSAnLi4vLi4vLi4vY29tcG9uZW50cy9TdGlja3kvaW5kZXgnCmltcG9ydCBXYXJuaW5nIGZyb20gJy4vV2FybmluZycKaW1wb3J0IEVib29rVXBsb2FkIGZyb20gJy4uLy4uLy4uL2NvbXBvbmVudHMvRWJvb2tVcGxvYWQnCmltcG9ydCBNZElucHV0IGZyb20gJy4uLy4uLy4uL2NvbXBvbmVudHMvTURpbnB1dCcKaW1wb3J0IHsgY3JlYXRlQm9vaywgZ2V0Qm9vaywgdXBkYXRlQm9vayB9IGZyb20gJy4uLy4uLy4uL2FwaS9ib29rJwpjb25zdCBkZWZhdWx0Rm9ybSA9IHsKICB0aXRsZTogJycsCiAgICAgICAgICBhdXRob3I6ICcnLAogICAgICAgICAgbGFuZ3V0YWdlOiAnJywKICAgICAgICAgIHB1Ymxpc2hlcjogJycsCiAgICAgICAgICByb290RmlsZTogJycsCiAgICAgICAgICBjb3ZlcjogJycsCiAgICAgICAgICB1cmw6ICcnLAogICAgICAgICAgb3JpZ2luYWxOYW1lOiAnJywKICAgICAgICAgIGZpbGVOYW1lOiAnJywKICAgICAgICAgIGNvdmVyUGF0aDogJycsCiAgICAgICAgICBmaWxlUGF0aDogJycsCiAgICAgICAgICB1bnppcFBhdGg6ICcnCn0KCi8v5pig5bCECmNvbnN0IGZpZWxkcyA9IHsKICB0aXRsZTogJ+agh+mimCcsCiAgYXV0aG9yOiAn5L2c6ICFJywKICBwdWJsaXNoZXI6ICflh7rniYjnpL4nLAogIGxhbmd1YWdlOiAn6K+t6KiAJwp9CgpleHBvcnQgZGVmYXVsdCB7CiAgY29tcG9uZW50czogeyBTdGlja3ksIFdhcm5pbmcsIEVib29rVXBsb2FkLCBNZElucHV0IH0sCiAgcHJvcHM6IHsKICAgIGlzRWRpdDogQm9vbGVhbgogIH0sCiAgZGF0YSgpIHsKICAgIC8v5qCh6aqM6KeE5YiZCiAgICBjb25zdCB2YWxpZGF0ZVJlcXVpcmUgPSAocnVsZSwgdmFsdWUsIGNhbGxiYWNrKSA9PiB7CiAgICAgIGlmKHZhbHVlLmxlbmd0aCA9PT0gMCkgewogICAgICAgIGNhbGxiYWNrKG5ldyBFcnJvcihmaWVsZHNbcnVsZS5maWVsZF0gKyAn5b+F6aG75aGr5YaZJykpCiAgICAgIH0gZWxzZSB7CiAgICAgICAgY2FsbGJhY2soKQogICAgICB9CiAgICB9CgogICAgcmV0dXJuIHsKICAgICAgbG9hZGluZzogZmFsc2UsCiAgICAgIHBvc3RGb3JtOiB7CiAgICAgICAgc3RhdHVzOiAnZHJhZnQnCiAgICAgIH0sCiAgICAgIGZpbGVMaXN0OiBbXSwKICAgICAgbGFiZWxXaWR0aDogJzEyMHB4JywKICAgICAgY29udGVudHNUcmVlOiBbXSwKICAgICAgLy/moKHpqozop4TliJkKICAgICAgcnVsZXM6IHsKICAgICAgICB0aXRsZTogW3sgdmFsaWRhdG9yOiB2YWxpZGF0ZVJlcXVpcmV9XSwKICAgICAgICBhdXRob3I6IFt7IHZhbGlkYXRvcjogdmFsaWRhdGVSZXF1aXJlfV0sCiAgICAgICAgbGFuZ3VhZ2U6IFt7IHZhbGlkYXRvcjogdmFsaWRhdGVSZXF1aXJlfV0sCiAgICAgICAgcHVibGlzaGVyOiBbeyB2YWxpZGF0b3I6IHZhbGlkYXRlUmVxdWlyZX1dCgogICAgICB9CiAgICB9CiAgfSwKICBjcmVhdGVkKCkgewoKICAgIGlmKHRoaXMuaXNFZGl0KSB7CiAgICAgIGNvbnN0IGZpbGVOYW1lID0gdGhpcy4kcm91dGUucGFyYW1zLmZpbGVOYW1lCiAgICAgIGNvbnNvbGUubG9nKGZpbGVOYW1lKQogICAgICB0aGlzLmdldEJvb2tEYXRhKGZpbGVOYW1lKQogICAgfQoKICB9LAogIG1ldGhvZHM6IHsKICAgIGdldEJvb2tEYXRhKGZpbGVOYW1lKSB7CiAgICAgIGdldEJvb2soZmlsZU5hbWUpLnRoZW4ocmVzcG9uc2UgPT4gewogICAgICAgIHRoaXMuc2V0RGF0YShyZXNwb25zZS5kYXRhKQogICAgICB9KQogICAgfSwKICAgIHNldERlZmF1bHQoKSB7ICAvL+e9ruepugogICAgICAvL3RoaXMucG9zdEZvcm0gPSBPYmplY3QuYXNzaWduKHt9LCBkZWZhdWx0Rm9ybSkKICAgICAgdGhpcy5jb250ZW50c1RyZWUgPSBbXQogICAgICB0aGlzLmZpbGVMaXN0ID0gW10KICAgICAgdGhpcy4kcmVmcy5wb3N0Rm9ybS5yZXNldEZpZWxkcygpCiAgICB9LAogICAgb25Db250ZW50Q2xpY2soZGF0YSkgewogICAgICAvL2FsZXJ0KGRhdGEpCiAgICAgIGNvbnNvbGUubG9nKGRhdGEpCiAgICAgIGlmKGRhdGEudGV4dCkgewogICAgICAgIHdpbmRvdy5vcGVuKGRhdGEudGV4dCkKICAgICAgfQogICAgfSwKCiAgICBzZXREYXRhKGRhdGEsIGNvbnRlbnRzVHJlZSkgewogICAgICAvL2FsZXJ0KGRhdGEuY29udGVudHNUcmVlKQoKICAgICAgY29uc3QgewogICAgICAgIHRpdGxlLAogICAgICAgIGF1dGhvciwKICAgICAgICBsYW5ndWFnZSwKICAgICAgICBwdWJsaXNoZXIsCiAgICAgICAgcm9vdEZpbGUsCiAgICAgICAgY292ZXIsCiAgICAgICAgdXJsLAoKICAgICAgICBvcmlnaW5hbE5hbWUsCiAgICAgICAgY29udGVudHMsCiAgICAgICAgZmlsZU5hbWUsCiAgICAgICAgY292ZXJQYXRoLAogICAgICAgIGZpbGVQYXRoLAogICAgICAgIHVuemlwUGF0aAogICAgICB9ID0gZGF0YQogICAgICAvL2FsZXJ0KG9yaWdpbmFsTmFtZSkKICAgICAgdGhpcy5wb3N0Rm9ybSA9IHsKICAgICAgICAuLi50aGlzLnBvc3RGb3JtLAogICAgICAgIHRpdGxlLAogICAgICAgIGF1dGhvciwKICAgICAgICBsYW5ndWFnZSwKCiAgICAgICAgcHVibGlzaGVyLAogICAgICAgIHJvb3RGaWxlLAogICAgICAgIGNvdmVyLAogICAgICAgIHVybCwKICAgICAgICBvcmlnaW5hbE5hbWUsCiAgICAgICAgY29udGVudHMsCiAgICAgICAgZmlsZU5hbWUsCiAgICAgICAgY292ZXJQYXRoLAogICAgICAgIGZpbGVQYXRoLAogICAgICAgIHVuemlwUGF0aAogICAgICB9CiAgICAgIC8vY29uc29sZS5sb2coJ3RpdGxlJywgdGl0bGUpCgogICAgICB0aGlzLmNvbnRlbnRzVHJlZSA9IGRhdGEuY29udGVudHNUcmVlCiAgICAgIHRoaXMuZmlsZUxpc3QgPSBbeyBuYW1lOiBvcmlnaW5hbE5hbWUsIHVybCB9XQoKICAgIH0sCiAgICBvblVwbG9hZFN1Y2Nlc3MoZGF0YSwgY29udGVudHNUcmVlKSB7CiAgICAgIGNvbnNvbGUubG9nKCdkYXRhJywgZGF0YSkKCiAgICAgIGNvbnNvbGUubG9nKCdkYXRhJywgZGF0YS5yZXNwb25zZS5kYXRhKQogICAgICAvL2FsZXJ0KGNvbnRlbnRzVHJlZSkKICAgICAgdGhpcy5zZXREYXRhKGRhdGEucmVzcG9uc2UuZGF0YSkKICAgIH0sCiAgICBvblVwbG9hZFJlbW92ZSgpIHsKICAgICAgdGhpcy5zZXREZWZhdWx0KCkKICAgIH0sCgogICAgc2hvd0d1aWRlKCkgewogICAgICBjb25zb2xlLmxvZygnc2hvdyBndWlkZSAuLi4nKQogICAgICAvL2FsZXJ0KCdhJykKICAgIH0sCiAgICAvKiBlc2xpbnQtZGlzYWJsZSAqLwogICAgc3VibWl0Rm9ybSgpIHsKICAgICAgY29uc3Qgb25TdWNjZXNzID0gKHJlc3BvbnNlKSA9PiB7CiAgICAgICAgY29uc3QgeyBtc2cgfSA9IHJlc3BvbnNlCiAgICAgICAgdGhpcy4kbm90aWZ5KHsKICAgICAgICAgIHRpdGxlOiAn5pON5L2c5oiQ5YqfJywKICAgICAgICAgIG1lc3NhZ2U6IG1zZywKICAgICAgICAgIHR5cGU6ICdzdWNjZXNzJywKICAgICAgICAgICAgZHVyYXRpb246IDIwMDAKICAgICAgICAgIH0pCiAgICAgICAgICB0aGlzLmxvYWRpbmcgPSBmYWxzZQogICAgICB9CgoKICAgICAgaWYoIXRoaXMubG9hZGluZykgewoKICAgICAgICAgICAgdGhpcy5sb2FkaW5nPXRydWUKCiAgICAgICAgICAgIHRoaXMuJHJlZnMucG9zdEZvcm0udmFsaWRhdGUoKHZhbGlkLCBmaWVsZHMpID0+IHsKICAgICAgICAgICAgICBjb25zb2xlLmxvZyh2YWxpZCwgZmllbGRzKQogICAgICAgICAgICAgIGlmKHZhbGlkKSB7CgogICAgICAgICAgICAgICAgLy/moKHpqozpgJrov4fvvIzmj5DkuqTooajljZUKICAgICAgICAgICAgICAgIC8v6KGo5Y2V6aG577yM5rWF5ou36LSdCiAgICAgICAgICAgICAgICBjb25zdCBib29rID0gT2JqZWN0LmFzc2lnbih7fSwgdGhpcy5wb3N0Rm9ybSkKICAgICAgICAgICAgICAgIC8vZGVsZXRlIGJvb2suY29udGVudHMKICAgICAgICAgICAgICAgIGRlbGV0ZSBib29rLmNvbnRlbnRzVHJlZQoKICAgICAgICAgICAgICAgIC8vYWxlcnQodGhpcy5pc0VkaXQpCiAgICAgICAgICAgICAgICBpZighdGhpcy5pc0VkaXQpIHsKICAgICAgICAgICAgICAgICAgY3JlYXRlQm9vayhib29rKS50aGVuKHJlc3BvbnNlID0+IHsKICAgICAgICAgICAgICAgICAgICBvblN1Y2Nlc3MocmVzcG9uc2UpCgogICAgICAgICAgICAgICAgICB9KS5jYXRjaCgoKSA9PiB7CiAgICAgICAgICAgICAgICAgICAgdGhpcy5sb2FkaW5nID0gZmFsc2UKICAgICAgICAgICAgICAgICAgfSkKCiAgICAgICAgICAgICAgICAgIC8vdGhpcy5zZXREZWZhdWx0KCkKICAgICAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgICAgIHVwZGF0ZUJvb2soYm9vaykudGhlbihyZXNwb25zZSA9PnsKICAgICAgICAgICAgICAgICAgICBvblN1Y2Nlc3MocmVzcG9uc2UpCgogICAgICAgICAgICAgICAgICB9KS5jYXRjaCgoKSA9PiB7CiAgICAgICAgICAgICAgICAgICAgdGhpcy5sb2FkaW5nID0gZmFsc2UKICAgICAgICAgICAgICAgICAgfSkKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgICAgY29uc3QgbWVzc2FnZSA9IGZpZWxkc1tPYmplY3Qua2V5cyhmaWVsZHMpWzBdXVswXS5tZXNzYWdlICAvL+iOt+WPlumUmeivr+S/oeaBrwogICAgICAgICAgICAgICAgdGhpcy4kbWVzc2FnZSh7bWVzc2FnZSwgdHlwZTogJ2Vycm9yJ30pICAgLy/liY3nq6/lsZXnpLoKICAgICAgICAgICAgICB9CgogICAgICAgICAgICB9KQogICAgICAgICAgICBzZXRUaW1lb3V0KCgpID0+IHsKICAgICAgICAgICAgICB0aGlzLmxvYWRpbmcgPSBmYWxzZQogICAgICAgICAgICB9LCAxMDAwKQogICAgICB9CgogICAgfQogIH0KCn0K"},{"version":3,"sources":["Detail.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAkJA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;AAGA;;AAEA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA","file":"Detail.vue","sourceRoot":"src/views/book/components","sourcesContent":["<template>\n  <el-form ref=\"postForm\" :model=\"postForm\" :rules=\"rules\">\n    <sticky :class-name=\"'sub-navbar'\">\n      <el-button v-if=\"!isEdit\" @click=\"showGuide\">显示帮助</el-button>\n      <el-button\n        v-loading=\"loading\"\n        @click=\"submitForm\"\n        type=\"success\"\n        style=\"margin-left: 5 0px\"\n      >{{ isEdit ? '编辑电子书' : '新增电子书' }}</el-button>\n    </sticky>\n    <div class=\"detail-container\">\n      <el-row>\n        <Warning />\n        <el-col :span=\"24\">\n          <!-- >上传控件的具体样式<-->\n          <ebook-upload\n            :file-list=\"fileList\"\n            :disabled=\"isEdit\"\n            @onSuccess = \"onUploadSuccess\"\n            @onRemove = \"onUploadRemove\"\n          />\n        </el-col>\n        <el-col :span=\"24\">\n          <el-form-item prop=\"title\">\n            <MdInput v-model=\"postForm.title\" :maxlength=\"100\" name=\"name\" required>\n            书名\n            </MdInput>\n          </el-form-item>\n          <el-row>\n            <el-col :span=\"12\">\n              <el-form-item prop=\"author\" label=\"作者：\" :label-width=\"labelWidth\">\n                <el-input\n                  v-model=\"postForm.author\"\n                  placeholder=\"作者\"\n                />\n              </el-form-item>\n\n            </el-col>\n            <el-col :span=\"12\">\n              <el-form-item prop=\"publisher\" label=\"出版社：\" :label-width=\"labelWidth\">\n              <el-input\n                v-model=\"postForm.publisher\"\n                placeholder=\"出版社\"\n              />\n              </el-form-item>\n            </el-col>\n\n          </el-row>\n\n          <el-row>\n            <el-col :span=\"12\">\n              <el-form-item prop=\"language\" label=\"语言：\" :label-width=\"labelWidth\">\n                <el-input\n                  v-model=\"postForm.language\"\n                  placeholder=\"语言\"\n                />\n              </el-form-item>\n\n            </el-col>\n            <el-col :span=\"12\">\n              <el-form-item prop=\"rootFile\" label=\"根文件：\" :label-width=\"labelWidth\">\n                <el-input\n                  v-model=\"postForm.rootFile\"\n                  placeholder=\"根文件\"\n                  disabled\n                 />\n              </el-form-item>\n            </el-col>\n          </el-row>\n\n          <el-row>\n            <el-col :span=\"12\">\n              <el-form-item prop=\"filePath\" label=\"文件路径：\" :label-width=\"labelWidth\">\n                <el-input\n                  v-model=\"postForm.filePath\"\n                  placeholder=\"文件路径\"\n                  disabled\n                />\n              </el-form-item>\n\n            </el-col>\n            <el-col :span=\"12\">\n              <el-form-item prop=\"unzipPath\" label=\"解压路径：\" :label-width=\"labelWidth\">\n                <el-input\n                  v-model=\"postForm.unzipPath\"\n                  placeholder=\"解压路径\"\n                  disabled\n                 />\n              </el-form-item>\n            </el-col>\n          </el-row>\n\n\n          <el-row>\n            <el-col :span=\"12\">\n              <el-form-item prop=\"coverFile\" label=\"封面路径：\" :label-width=\"labelWidth\">\n                <el-input\n                  v-model=\"postForm.coverPath\"\n                  placeholder=\"封面路径\"\n                  disabled\n                />\n              </el-form-item>\n\n            </el-col>\n            <el-col :span=\"12\">\n              <el-form-item prop=\"originalName\" label=\"文件名称：\" :label-width=\"labelWidth\">\n                <el-input\n                  v-model=\"postForm.originalName\"\n                  placeholder=\"文件名称\"\n                  disabled\n                 />\n              </el-form-item>\n            </el-col>\n          </el-row>\n\n          <el-row>\n            <el-col :span=\"12\">\n              <el-form-item prop=\"cover\" label=\"封面：\" :label-width=\"labelWidth\">\n                <a v-if=\"postForm.cover\" :href=\"postForm.cover\" target=\"_blank\">\n\n                  <img :src=\"postForm.cover\" class=\"preview-img\" />\n                </a>\n                <span v-else>无</span>\n              </el-form-item>\n\n            </el-col>\n          </el-row>\n        </el-col>\n\n      </el-row>\n\n      <el-row>\n        <el-col :span=\"24\">\n          <el-form-item label=\"目录：\" :label-width=\"labelWidth\">\n            <div v-if=\"contentsTree && contentsTree.length > 0\" class=\"contents-wrapper\">\n              <el-tree :data=\"contentsTree\" @node-click=\"onContentClick\" />\n            </div>\n          </el-form-item>\n        </el-col>\n      </el-row>\n\n    </div>\n  </el-form>\n</template>\n<script>\nimport Sticky from '../../../components/Sticky/index'\nimport Warning from './Warning'\nimport EbookUpload from '../../../components/EbookUpload'\nimport MdInput from '../../../components/MDinput'\nimport { createBook, getBook, updateBook } from '../../../api/book'\nconst defaultForm = {\n  title: '',\n          author: '',\n          langutage: '',\n          publisher: '',\n          rootFile: '',\n          cover: '',\n          url: '',\n          originalName: '',\n          fileName: '',\n          coverPath: '',\n          filePath: '',\n          unzipPath: ''\n}\n\n//映射\nconst fields = {\n  title: '标题',\n  author: '作者',\n  publisher: '出版社',\n  language: '语言'\n}\n\nexport default {\n  components: { Sticky, Warning, EbookUpload, MdInput },\n  props: {\n    isEdit: Boolean\n  },\n  data() {\n    //校验规则\n    const validateRequire = (rule, value, callback) => {\n      if(value.length === 0) {\n        callback(new Error(fields[rule.field] + '必须填写'))\n      } else {\n        callback()\n      }\n    }\n\n    return {\n      loading: false,\n      postForm: {\n        status: 'draft'\n      },\n      fileList: [],\n      labelWidth: '120px',\n      contentsTree: [],\n      //校验规则\n      rules: {\n        title: [{ validator: validateRequire}],\n        author: [{ validator: validateRequire}],\n        language: [{ validator: validateRequire}],\n        publisher: [{ validator: validateRequire}]\n\n      }\n    }\n  },\n  created() {\n\n    if(this.isEdit) {\n      const fileName = this.$route.params.fileName\n      console.log(fileName)\n      this.getBookData(fileName)\n    }\n\n  },\n  methods: {\n    getBookData(fileName) {\n      getBook(fileName).then(response => {\n        this.setData(response.data)\n      })\n    },\n    setDefault() {  //置空\n      //this.postForm = Object.assign({}, defaultForm)\n      this.contentsTree = []\n      this.fileList = []\n      this.$refs.postForm.resetFields()\n    },\n    onContentClick(data) {\n      //alert(data)\n      console.log(data)\n      if(data.text) {\n        window.open(data.text)\n      }\n    },\n\n    setData(data, contentsTree) {\n      //alert(data.contentsTree)\n\n      const {\n        title,\n        author,\n        language,\n        publisher,\n        rootFile,\n        cover,\n        url,\n\n        originalName,\n        contents,\n        fileName,\n        coverPath,\n        filePath,\n        unzipPath\n      } = data\n      //alert(originalName)\n      this.postForm = {\n        ...this.postForm,\n        title,\n        author,\n        language,\n\n        publisher,\n        rootFile,\n        cover,\n        url,\n        originalName,\n        contents,\n        fileName,\n        coverPath,\n        filePath,\n        unzipPath\n      }\n      //console.log('title', title)\n\n      this.contentsTree = data.contentsTree\n      this.fileList = [{ name: originalName, url }]\n\n    },\n    onUploadSuccess(data, contentsTree) {\n      console.log('data', data)\n\n      console.log('data', data.response.data)\n      //alert(contentsTree)\n      this.setData(data.response.data)\n    },\n    onUploadRemove() {\n      this.setDefault()\n    },\n\n    showGuide() {\n      console.log('show guide ...')\n      //alert('a')\n    },\n    /* eslint-disable */\n    submitForm() {\n      const onSuccess = (response) => {\n        const { msg } = response\n        this.$notify({\n          title: '操作成功',\n          message: msg,\n          type: 'success',\n            duration: 2000\n          })\n          this.loading = false\n      }\n\n\n      if(!this.loading) {\n\n            this.loading=true\n\n            this.$refs.postForm.validate((valid, fields) => {\n              console.log(valid, fields)\n              if(valid) {\n\n                //校验通过，提交表单\n                //表单项，浅拷贝\n                const book = Object.assign({}, this.postForm)\n                //delete book.contents\n                delete book.contentsTree\n\n                //alert(this.isEdit)\n                if(!this.isEdit) {\n                  createBook(book).then(response => {\n                    onSuccess(response)\n\n                  }).catch(() => {\n                    this.loading = false\n                  })\n\n                  //this.setDefault()\n                } else {\n                  updateBook(book).then(response =>{\n                    onSuccess(response)\n\n                  }).catch(() => {\n                    this.loading = false\n                  })\n                }\n              } else {\n                const message = fields[Object.keys(fields)[0]][0].message  //获取错误信息\n                this.$message({message, type: 'error'})   //前端展示\n              }\n\n            })\n            setTimeout(() => {\n              this.loading = false\n            }, 1000)\n      }\n\n    }\n  }\n\n}\n</script>\n<style lang=\"scss\" scoped>\n  .detail-container {\n    padding:40px 50px 20px;\n    .preview-img {\n      width: 200px;\n      height: 270px;\n    }\n  }\n</style>\n"]}]}